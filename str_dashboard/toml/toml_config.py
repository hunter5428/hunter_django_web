# str_dashboard/toml/toml_config.py
"""
TOML Export 설정 관리
각 섹션별 마스킹 규칙과 필드 설정을 정의
"""

from typing import Dict, Any, List, Optional


class TomlFieldConfig:
    """TOML 필드 설정 관리 클래스"""
    
    # ==================== 고객 정보 설정 ====================
    CUSTOMER_INFO = {
        # 필드명 매핑 (DB 컬럼명 -> TOML 필드명)
        'field_mapping': {
            '고객ID': '고객ID',
            'MID': 'MID',
            '성명': '성명',
            '영문명': '영문명',
            '고객구분': '고객구분',
            'RA등급': 'RA등급',
            '위험등급': '위험등급',
            '고액자산가': '고액자산가',
            '생년월일': '생년월일',
            '성별': '성별',
            '연락처': '휴대폰번호',
            '이메일': '이메일',
            '국적': '국적',
            '국적코드': '국적코드',
            '거주지국가': '거주지국가',
            '거주지주소': '거주지주소',
            '직업': '직업',
            '직장명': '직장명',
            '직장주소': '직장주소',
            '거래목적': '거래목적',
            'STR보고건수': 'STR보고건수',
            '최종STR보고일': '최종STR보고일',
            'Alert건수': 'Alert건수',
            'KYC완료일시': 'KYC완료일시',
            '심사상태': '심사상태'
        },
        
        # 고정 마스킹 값 (실제 값과 무관하게 항상 이 값으로 치환)
        'fixed_masking': {
            '고객ID': '{cust_id}',  # 동적 치환
            'MID': '{mid}',  # 동적 치환
            '휴대폰번호': '01077778888'
        },
        
        # 제외할 필드 (TOML에 포함하지 않음)
        'exclude_fields': [
            '실명번호구분',
            '실명번호',
            '거주지상세주소',
            '거주지우편번호',
            '직장우편번호',
            '직장상세주소',
            '사업장우편번호',
            '사업장상세주소',
            'CUST_TYPE_CD'  # 내부 코드
        ],
        
        # 부분 마스킹 규칙
        'partial_masking': {
            '거주지주소': 'district_only',      # 구 단위까지만
            '직장주소': 'district_only',        # 구 단위까지만
            '생년월일': 'year_only',            # 연도만 (1984년생)
            '설립일': 'year_only',              # 연도만 (법인용)
            '성명': 'surname_only',             # 성만 표시 (김**)
            '이메일': 'domain_only'             # 도메인만 표시
        }
    }
    
    # ==================== 동일 차명의심 설정 ====================
    DUPLICATE_PERSON = {
        # 매칭된 필드를 설명으로 변환
        'match_descriptions': {
            'ADDRESS': '거주주소',
            'EMAIL': '이메일',
            'WORKPLACE_NAME': '직장명',
            'WORKPLACE_ADDRESS': '직장주소',
            'PHONE': '휴대폰번호(뒷자리)',
            'phone_suffix': '휴대폰번호(뒷자리)'
        },
        
        # 출력 형식
        'output_format': 'text_description'  # 실제값 대신 설명 문자열
    }
    
    # ==================== 관련인 정보 설정 ====================
    RELATED_PERSON = {
        # 필드명 매핑
        'field_mapping': {
            '관련인고객ID': '관련인고객ID',
            '관련인MID': '관련인MID',
            '관계유형': '관계유형',
            '관련인성명': '관련인성명',
            '관련인영문명': '관련인영문명',
            '관련인생년월일': '관련인생년월일',
            '관련인성별': '관련인성별',
            '관련인국적': '관련인국적',
            '관련인연락처': '관련인연락처',
            '관련인이메일': '관련인이메일',
            '관련인거주지주소': '관련인거주지주소',
            '관련인직업': '관련인직업',
            '관련인직장명': '관련인직장명',
            '관련인위험등급': '관련인위험등급',
            '지분율': '지분율',
            '내부입고금액': '내부입고금액',
            '내부출고금액': '내부출고금액',
            '거래횟수': '거래횟수'
        },
        
        # 제외 필드
        'exclude_fields': [
            '관련인실명번호',
            '종목별거래상세',  # JSON 데이터
            '관계유형코드'
        ]
    }


# 싱글톤 인스턴스
toml_config = TomlFieldConfig()